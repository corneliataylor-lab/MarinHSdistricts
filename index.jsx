import { useState, useMemo } from "react";
import * as d3 from "d3";

const geoData = {"type": "FeatureCollection", "features": [{"type": "Feature", "properties": {"District": "Tamalpais School District"}, "geometry": {"type": "Polygon", "coordinates": [[[-122.7145, 38.1266], [-122.7021, 38.1203], [-122.7011, 38.1137], [-122.7052, 38.1112], [-122.705, 38.1045], [-122.6967, 38.1023], [-122.6914, 38.0985], [-122.6868, 38.0983], [-122.684, 38.0962], [-122.678, 38.098], [-122.6666, 38.0965], [-122.6675, 38.0879], [-122.6551, 38.0879], [-122.653, 38.0896], [-122.6465, 38.0903], [-122.6431, 38.0881], [-122.6404, 38.084], [-122.6385, 38.0761], [-122.6322, 38.0737], [-122.6308, 38.0644], [-122.6393, 38.0516], [-122.6437, 38.0475], [-122.6355, 38.0277], [-122.6365, 38.026], [-122.6323, 38.0255], [-122.6173, 38.0194], [-122.6126, 38.0216], [-122.6124, 38.0232], [-122.597, 38.0292], [-122.571, 38.0096], [-122.5575, 37.9937], [-122.561, 37.9792], [-122.5573, 37.9835], [-122.5504, 37.9808], [-122.5509, 37.9722], [-122.5486, 37.9723], [-122.5461, 37.9669], [-122.5452, 37.9685], [-122.5456, 37.9669], [-122.5436, 37.9653], [-122.5382, 37.9642], [-122.5387, 37.9633], [-122.5328, 37.9613], [-122.5325, 37.96], [-122.5284, 37.9588], [-122.5172, 37.9517], [-122.5116, 37.9527], [-122.5095, 37.9519], [-122.5132, 37.9469], [-122.5131, 37.9431], [-122.5022, 37.942], [-122.4959, 37.9383], [-122.4893, 37.9363], [-122.435, 37.9368], [-122.432, 37.9298], [-122.4187, 37.8529], [-122.4728, 37.8319], [-122.4745, 37.8336], [-122.4778, 37.8332], [-122.477, 37.8311], [-122.4784, 37.8309], [-122.4781, 37.8254], [-122.4833, 37.8256], [-122.4846, 37.8269], [-122.4912, 37.8266], [-122.4958, 37.8221], [-122.4996, 37.8219], [-122.4991, 37.8198], [-122.5006, 37.8198], [-122.5017, 37.8215], [-122.5045, 37.821], [-122.5058, 37.8231], [-122.5113, 37.8247], [-122.5237, 37.8248], [-122.5255, 37.8211], [-122.5289, 37.8201], [-122.5277, 37.8151], [-122.5297, 37.8151], [-122.5291, 37.8163], [-122.5318, 37.8191], [-122.532, 37.8211], [-122.5361, 37.8241], [-122.5344, 37.8254], [-122.5362, 37.8291], [-122.5464, 37.8341], [-122.5492, 37.8339], [-122.5514, 37.8402], [-122.5541, 37.8422], [-122.5555, 37.8417], [-122.5559, 37.8444], [-122.5597, 37.8454], [-122.559, 37.8479], [-122.5616, 37.849], [-122.5623, 37.852], [-122.5667, 37.8539], [-122.5705, 37.8536], [-122.5783, 37.8598], [-122.5805, 37.8597], [-122.5808, 37.8577], [-122.5824, 37.8572], [-122.5821, 37.8585], [-122.5889, 37.8615], [-122.5907, 37.8646], [-122.6021, 37.8754], [-122.6053, 37.8753], [-122.6132, 37.8784], [-122.6182, 37.877], [-122.6211, 37.878], [-122.6234, 37.8807], [-122.6288, 37.8816], [-122.6282, 37.8848], [-122.641, 37.896], [-122.6594, 37.9045], [-122.6787, 37.9065], [-122.6831, 37.9061], [-122.6977, 37.8986], [-122.7013, 37.8937], [-122.7054, 37.8943], [-122.7102, 37.8962], [-122.7135, 37.9002], [-122.727, 37.9031], [-122.7308, 37.9159], [-122.7369, 37.9258], [-122.7493, 37.9312], [-122.7546, 37.9355], [-122.7661, 37.938], [-122.7707, 37.9439], [-122.7766, 37.9436], [-122.776, 37.9457], [-122.7779, 37.9481], [-122.7833, 37.9483], [-122.784, 37.9545], [-122.7917, 37.9694], [-122.7985, 37.9778], [-122.805, 37.9827], [-122.7743, 37.9833], [-122.7746, 37.9963], [-122.7637, 37.9964], [-122.7631, 37.995], [-122.7607, 37.9965], [-122.7598, 37.9946], [-122.7592, 37.9965], [-122.7565, 37.9961], [-122.7553, 37.9983], [-122.7545, 37.9968], [-122.7446, 37.9984], [-122.7294, 38.0044], [-122.7249, 38.0004], [-122.7119, 38.0096], [-122.7114, 38.0056], [-122.7091, 38.0046], [-122.709, 38.0116], [-122.7174, 38.0228], [-122.7175, 38.0282], [-122.6983, 38.0337], [-122.7132, 38.039], [-122.7168, 38.0388], [-122.7205, 38.0412], [-122.721, 38.0471], [-122.7267, 38.0557], [-122.7355, 38.0575], [-122.7389, 38.0564], [-122.7497, 38.0671], [-122.7584, 38.0711], [-122.7599, 38.0707], [-122.7603, 38.0718], [-122.7642, 38.069], [-122.7703, 38.0703], [-122.7649, 38.0747], [-122.7636, 38.0782], [-122.7674, 38.0838], [-122.7677, 38.089], [-122.7753, 38.0958], [-122.7708, 38.1034], [-122.779, 38.1131], [-122.7647, 38.1252], [-122.7603, 38.1217], [-122.7272, 38.1332], [-122.7145, 38.1266]], [[-122.5329, 37.9612], [-122.5329, 37.9612]], [[-122.516, 37.9516], [-122.516, 37.9516]]]}}, {"type": "Feature", "properties": {"District": "Shoreline Unified"}, "geometry": {"type": "Polygon", "coordinates": [[[-123.0853, 38.4213], [-123.0732, 38.4229], [-123.0699, 38.4216], [-123.067, 38.422], [-123.0493, 38.418], [-123.0463, 38.4149], [-123.043, 38.4142], [-123.0411, 38.4169], [-123.0382, 38.4175], [-123.0368, 38.4154], [-123.0384, 38.4118], [-123.0359, 38.4105], [-123.034, 38.411], [-123.0329, 38.4093], [-123.031, 38.4094], [-123.0269, 38.4066], [-123.009, 38.4029], [-123.0078, 38.3996], [-123.0126, 38.3978], [-123.0124, 38.3964], [-123.0183, 38.3935], [-123.0188, 38.391], [-123.0173, 38.3896], [-123.0169, 38.3864], [-123.0295, 38.3854], [-123.0279, 38.384], [-123.0239, 38.3679], [-123.0204, 38.3643], [-123.0208, 38.3628], [-123.0236, 38.3616], [-123.0298, 38.3647], [-123.0347, 38.3642], [-123.039, 38.3601], [-123.0456, 38.3617], [-123.0481, 38.3606], [-123.0468, 38.3476], [-123.0451, 38.3462], [-123.0419, 38.3468], [-123.0374, 38.3493], [-123.0232, 38.3483], [-123.0215, 38.3271], [-123.0148, 38.3237], [-123.0143, 38.3214], [-123.0184, 38.3189], [-123.0139, 38.3171], [-123.0016, 38.3161], [-123.0023, 38.3151], [-122.9941, 38.3034], [-122.9949, 38.3061], [-122.9911, 38.3054], [-122.9881, 38.3081], [-122.9843, 38.3083], [-122.9822, 38.311], [-122.9742, 38.3117], [-122.9725, 38.3106], [-122.9655, 38.3329], [-122.9533, 38.3289], [-122.9525, 38.3392], [-122.9422, 38.3381], [-122.9409, 38.3528], [-122.9498, 38.3477], [-122.9546, 38.3477], [-122.9598, 38.3452], [-122.9584, 38.3566], [-122.9611, 38.3605], [-122.9608, 38.3615], [-122.9564, 38.362], [-122.9546, 38.3725], [-122.9228, 38.3705], [-122.9223, 38.3658], [-122.8967, 38.3658], [-122.8963, 38.3627], [-122.8871, 38.3629], [-122.8869, 38.3588], [-122.882, 38.3586], [-122.8839, 38.3298], [-122.8646, 38.3298], [-122.8628, 38.3452], [-122.8465, 38.3437], [-122.8466, 38.3485], [-122.8317, 38.3474], [-122.8307, 38.3515], [-122.8229, 38.3517], [-122.824, 38.3375], [-122.8141, 38.3371], [-122.814, 38.3297], [-122.7995, 38.3282], [-122.7993, 38.3338], [-122.7938, 38.332], [-122.7934, 38.3299], [-122.7835, 38.3297], [-122.7852, 38.3159], [-122.7754, 38.3172], [-122.7763, 38.3079], [-122.79, 38.3075], [-122.791, 38.3008], [-122.8078, 38.3005], [-122.8076, 38.3082], [-122.8103, 38.3083], [-122.8076, 38.3107], [-122.8071, 38.3154], [-122.8262, 38.3154], [-122.8274, 38.3084], [-122.8375, 38.3081], [-122.8384, 38.3022], [-122.8407, 38.3002], [-122.8385, 38.2999], [-122.8391, 38.2945], [-122.838, 38.2936], [-122.8353, 38.2934], [-122.8349, 38.2952], [-122.8305, 38.2951], [-122.8288, 38.294], [-122.8338, 38.28], [-122.8264, 38.2813], [-122.8262, 38.283], [-122.82, 38.2834], [-122.8198, 38.287], [-122.8156, 38.2872], [-122.8148, 38.2942], [-122.8167, 38.2943], [-122.8163, 38.2999], [-122.805, 38.2973], [-122.8067, 38.2859], [-122.8107, 38.2786], [-122.821, 38.2782], [-122.8225, 38.2713], [-122.826, 38.2713], [-122.8266, 38.2659], [-122.7919, 38.2424], [-122.8073, 38.2353], [-122.8176, 38.2358], [-122.8268, 38.2182], [-122.826, 38.2159], [-122.83, 38.2118], [-122.8433, 38.2102], [-122.8482, 38.2123], [-122.8514, 38.2083], [-122.8554, 38.2125], [-122.8557, 38.2145], [-122.8578, 38.2148], [-122.858, 38.2128], [-122.8599, 38.212], [-122.8606, 38.21], [-122.859, 38.2069], [-122.8601, 38.2047], [-122.8584, 38.2027], [-122.8605, 38.1995], [-122.8571, 38.1995], [-122.8567, 38.2022], [-122.8549, 38.2025], [-122.853, 38.1976], [-122.8465, 38.1957], [-122.8452, 38.1929], [-122.8407, 38.1925], [-122.8391, 38.1893], [-122.8396, 38.1848], [-122.8364, 38.1805], [-122.8436, 38.1702], [-122.8044, 38.1449], [-122.805, 38.1404], [-122.7737, 38.1175], [-122.779, 38.1131], [-122.7708, 38.1034], [-122.7753, 38.0958], [-122.7677, 38.089], [-122.7674, 38.0838], [-122.7636, 38.0782], [-122.7649, 38.0747], [-122.7703, 38.0703], [-122.7642, 38.069], [-122.7603, 38.0718], [-122.7599, 38.0707], [-122.7584, 38.0711], [-122.7497, 38.0671], [-122.7389, 38.0564], [-122.7355, 38.0575], [-122.7267, 38.0557], [-122.721, 38.0471], [-122.7205, 38.0412], [-122.7168, 38.0388], [-122.7132, 38.039], [-122.6983, 38.0337], [-122.7175, 38.0282], [-122.7174, 38.0228], [-122.709, 38.0116], [-122.7091, 38.0046], [-122.7114, 38.0056], [-122.7119, 38.0096], [-122.7249, 38.0004], [-122.7294, 38.0044], [-122.7446, 37.9984], [-122.7545, 37.9968], [-122.7553, 37.9983], [-122.7565, 37.9961], [-122.7592, 37.9965], [-122.7598, 37.9946], [-122.7607, 37.9965], [-122.7631, 37.995], [-122.7637, 37.9964], [-122.7746, 37.9963], [-122.7743, 37.9833], [-122.805, 37.9827], [-122.8097, 37.9856], [-122.8126, 37.9853], [-122.8214, 37.9967], [-122.8253, 37.9989], [-122.8283, 37.9982], [-122.8283, 38.0], [-122.8327, 38.0034], [-122.8587, 38.0177], [-122.8917, 38.0275], [-122.909, 38.0297], [-122.9145, 38.0284], [-122.9288, 38.0289], [-122.932, 38.0308], [-122.9305, 38.0331], [-122.9239, 38.0293], [-122.9118, 38.0292], [-122.9079, 38.0305], [-122.8905, 38.0285], [-122.8888, 38.03], [-122.8912, 38.0318], [-122.8929, 38.0359], [-122.8945, 38.0328], [-122.8977, 38.0316], [-122.9027, 38.0317], [-122.9083, 38.034], [-122.9033, 38.0424], [-122.9067, 38.0456], [-122.9056, 38.0474], [-122.9094, 38.0516], [-122.9105, 38.0451], [-122.9138, 38.0396], [-122.913, 38.0366], [-122.9145, 38.0335], [-122.9172, 38.0338], [-122.9182, 38.0371], [-122.9194, 38.0334], [-122.921, 38.033], [-122.9245, 38.0333], [-122.9271, 38.0359], [-122.9319, 38.0356], [-122.9328, 38.0389], [-122.9319, 38.0419], [-122.9367, 38.0446], [-122.9376, 38.0464], [-122.9333, 38.0548], [-122.9245, 38.0598], [-122.9222, 38.0599], [-122.9223, 38.0619], [-122.9199, 38.0636], [-122.9217, 38.066], [-122.9174, 38.0682], [-122.9191, 38.0702], [-122.9231, 38.0713], [-122.9268, 38.0638], [-122.9286, 38.0625], [-122.9331, 38.0646], [-122.9333, 38.0729], [-122.9352, 38.0748], [-122.9319, 38.0804], [-122.9354, 38.0845], [-122.9312, 38.0864], [-122.9292, 38.0905], [-122.9302, 38.0913], [-122.9347, 38.0894], [-122.9344, 38.0866], [-122.9376, 38.0832], [-122.9371, 38.0807], [-122.9403, 38.0775], [-122.9397, 38.0712], [-122.9421, 38.0666], [-122.9417, 38.0634], [-122.9443, 38.0608], [-122.953, 38.0606], [-122.9545, 38.062], [-122.9533, 38.0637], [-122.9543, 38.0661], [-122.9532, 38.0715], [-122.9546, 38.0726], [-122.9547, 38.0756], [-122.9574, 38.0775], [-122.9556, 38.0699], [-122.9584, 38.0666], [-122.9564, 38.0633], [-122.9579, 38.0618], [-122.9501, 38.0567], [-122.9479, 38.0534], [-122.9488, 38.0494], [-122.9557, 38.0518], [-122.96, 38.0555], [-122.9633, 38.0553], [-122.9595, 38.0532], [-122.9615, 38.053], [-122.9586, 38.0516], [-122.9568, 38.0489], [-122.9492, 38.0461], [-122.9424, 38.0391], [-122.9402, 38.0349], [-122.9374, 38.0358], [-122.9361, 38.0339], [-122.9404, 38.0316], [-122.9569, 38.0287], [-122.9666, 38.0242], [-122.9764, 38.0163], [-122.9833, 38.0054], [-122.9833, 37.9979], [-122.973, 37.9942], [-122.9675, 37.9939], [-122.9645, 37.9901], [-122.973, 37.9903], [-122.974, 37.9923], [-122.9785, 37.9929], [-122.9865, 37.9921], [-122.9908, 37.9948], [-122.9947, 37.9929], [-122.9967, 37.9943], [-123.0032, 37.9926], [-123.0077, 37.9954], [-123.0113, 37.9944], [-123.0123, 37.9951], [-123.0139, 37.9936], [-123.024, 37.9946], [-123.0205, 38.0], [-123.0165, 37.9988], [-123.0119, 38.0029], [-122.9984, 38.0288], [-122.9745, 38.0804], [-122.9584, 38.1193], [-122.9521, 38.1386], [-122.9488, 38.1542], [-122.9496, 38.1642], [-122.9522, 38.1668], [-122.952, 38.1698], [-122.9549, 38.1706], [-122.9532, 38.1713], [-122.9531, 38.1729], [-122.9549, 38.1772], [-122.9644, 38.1813], [-122.9664, 38.1832], [-122.9681, 38.1826], [-122.9654, 38.185], [-122.965, 38.1871], [-122.9663, 38.1985], [-122.9681, 38.2024], [-122.9806, 38.2143], [-122.9818, 38.2227], [-122.9878, 38.2267], [-122.9881, 38.2293], [-122.9923, 38.2329], [-122.9956, 38.2394], [-122.9948, 38.241], [-122.9876, 38.238], [-122.9788, 38.2292], [-122.9727, 38.2328], [-122.9717, 38.2363], [-122.9699, 38.2378], [-122.9673, 38.2493], [-122.9684, 38.2536], [-122.9705, 38.2554], [-122.9711, 38.2593], [-122.9739, 38.2613], [-122.9775, 38.2665], [-122.9776, 38.2698], [-122.9749, 38.2702], [-122.9808, 38.2704], [-122.9837, 38.273], [-122.9864, 38.2732], [-122.9889, 38.2774], [-122.9887, 38.28], [-122.9948, 38.2831], [-122.9969, 38.2862], [-122.9971, 38.2895], [-123.0001, 38.2909], [-123.0013, 38.2951], [-123.0002, 38.2974], [-123.0062, 38.2996], [-123.0129, 38.306], [-123.0246, 38.3125], [-123.0301, 38.3141], [-123.0422, 38.3147], [-123.0504, 38.3116], [-123.0531, 38.3075], [-123.0552, 38.308], [-123.0552, 38.3097], [-123.0486, 38.3164], [-123.0399, 38.3175], [-123.0328, 38.3158], [-123.0311, 38.3168], [-123.0325, 38.3203], [-123.0379, 38.3202], [-123.0374, 38.3237], [-123.0394, 38.3267], [-123.0463, 38.3313], [-123.0493, 38.3351], [-123.0603, 38.3366], [-123.0587, 38.3308], [-123.0558, 38.3291], [-123.0568, 38.3243], [-123.0551, 38.3212], [-123.0564, 38.3162], [-123.061, 38.3135], [-123.0583, 38.3114], [-123.0572, 38.3067], [-123.052, 38.3054], [-123.0513, 38.3023], [-123.0526, 38.301], [-123.0552, 38.301], [-123.0576, 38.2991], [-123.0624, 38.3034], [-123.0649, 38.3037], [-123.0641, 38.307], [-123.0677, 38.3089], [-123.0676, 38.3107], [-123.0712, 38.3146], [-123.0695, 38.3174], [-123.0738, 38.3173], [-123.0742, 38.3197], [-123.0778, 38.3209], [-123.0787, 38.3246], [-123.0739, 38.3233], [-123.0724, 38.324], [-123.0686, 38.3385], [-123.0684, 38.3466], [-123.0698, 38.3531], [-123.0689, 38.3592], [-123.0733, 38.369], [-123.0786, 38.3735], [-123.0826, 38.379], [-123.0824, 38.382], [-123.0886, 38.3936], [-123.0909, 38.3962], [-123.095, 38.3965], [-123.0957, 38.3951], [-123.0984, 38.3974], [-123.0984, 38.4026], [-123.1021, 38.4099], [-123.1034, 38.4177], [-123.1056, 38.4197], [-123.1033, 38.4223], [-123.096, 38.425], [-123.0853, 38.4213]]]}}, {"type": "Feature", "properties": {"District": "Petaluma High School District"}, "geometry": {"type": "Polygon", "coordinates": [[[-122.7827, 38.2362], [-122.7393, 38.2067], [-122.7235, 38.2073], [-122.7144, 38.2035], [-122.7143, 38.201], [-122.7104, 38.1993], [-122.7094, 38.1973], [-122.7056, 38.1984], [-122.7007, 38.1959], [-122.6885, 38.1949], [-122.6807, 38.1899], [-122.6749, 38.189], [-122.6677, 38.1898], [-122.6638, 38.1864], [-122.659, 38.1871], [-122.6534, 38.1848], [-122.6498, 38.1818], [-122.6453, 38.1659], [-122.6425, 38.161], [-122.6421, 38.1567], [-122.6471, 38.1537], [-122.6481, 38.1505], [-122.6414, 38.1467], [-122.6345, 38.1506], [-122.6211, 38.1526], [-122.6088, 38.1478], [-122.6089, 38.1388], [-122.6147, 38.1261], [-122.6171, 38.1248], [-122.6197, 38.1196], [-122.6254, 38.1224], [-122.63, 38.12], [-122.6297, 38.1056], [-122.6526, 38.1066], [-122.6671, 38.1051], [-122.6666, 38.0965], [-122.678, 38.098], [-122.684, 38.0962], [-122.6868, 38.0983], [-122.6914, 38.0985], [-122.6967, 38.1023], [-122.705, 38.1045], [-122.7052, 38.1112], [-122.7011, 38.1137], [-122.7021, 38.1203], [-122.7272, 38.1332], [-122.7603, 38.1217], [-122.7647, 38.1252], [-122.7737, 38.1175], [-122.805, 38.1404], [-122.8044, 38.1449], [-122.8436, 38.1702], [-122.8364, 38.1805], [-122.8396, 38.1848], [-122.8391, 38.1893], [-122.8407, 38.1926], [-122.8452, 38.1929], [-122.8465, 38.1957], [-122.8533, 38.1978], [-122.8549, 38.2025], [-122.8567, 38.2022], [-122.8571, 38.1995], [-122.8605, 38.1994], [-122.8584, 38.2027], [-122.8601, 38.2047], [-122.859, 38.2069], [-122.8606, 38.21], [-122.8599, 38.212], [-122.858, 38.2128], [-122.8578, 38.2148], [-122.8557, 38.2145], [-122.8554, 38.2125], [-122.8514, 38.2083], [-122.8482, 38.2123], [-122.8433, 38.2102], [-122.83, 38.2118], [-122.826, 38.2159], [-122.8268, 38.2182], [-122.8176, 38.2358], [-122.8073, 38.2353], [-122.792, 38.2425], [-122.7827, 38.2362]]]}}, {"type": "Feature", "properties": {"District": "Novato Unified"}, "geometry": {"type": "MultiPolygon", "coordinates": [[[[-122.4579, 38.1002], [-122.3475, 38.0733], [-122.376, 38.0485], [-122.3828, 38.0398], [-122.4958, 38.0399], [-122.4954, 38.0408], [-122.5048, 38.0409], [-122.5257, 38.0397], [-122.5317, 38.0427], [-122.5361, 38.0427], [-122.5316, 38.0501], [-122.531, 38.0575], [-122.5379, 38.0667], [-122.5421, 38.0756], [-122.5463, 38.0799], [-122.5457, 38.0805], [-122.5348, 38.0874], [-122.5338, 38.0843], [-122.5282, 38.0815], [-122.5285, 38.0877], [-122.5232, 38.0876], [-122.5178, 38.0916], [-122.5148, 38.0911], [-122.5123, 38.0853], [-122.5061, 38.085], [-122.5024, 38.0896], [-122.4965, 38.0934], [-122.4938, 38.0943], [-122.4938, 38.0922], [-122.4895, 38.095], [-122.4872, 38.0993], [-122.4827, 38.0992], [-122.484, 38.1078], [-122.4579, 38.1002]]], [[[-122.5915, 38.1876], [-122.5918, 38.1865], [-122.5906, 38.1859], [-122.5866, 38.1878], [-122.5833, 38.187], [-122.5821, 38.188], [-122.582, 38.1862], [-122.5782, 38.1836], [-122.5732, 38.1833], [-122.5707, 38.1835], [-122.5732, 38.1863], [-122.5706, 38.1871], [-122.5689, 38.1845], [-122.5653, 38.1827], [-122.5685, 38.177], [-122.5645, 38.1751], [-122.5632, 38.1693], [-122.5592, 38.1686], [-122.5543, 38.1701], [-122.552, 38.169], [-122.558, 38.1635], [-122.5579, 38.1602], [-122.5496, 38.1573], [-122.5445, 38.1587], [-122.5348, 38.1492], [-122.5211, 38.1415], [-122.514, 38.1338], [-122.5113, 38.1249], [-122.5069, 38.1167], [-122.5, 38.1115], [-122.484, 38.1078], [-122.4827, 38.0992], [-122.4872, 38.0993], [-122.4895, 38.095], [-122.4938, 38.0922], [-122.4938, 38.0943], [-122.4965, 38.0934], [-122.5024, 38.0896], [-122.5061, 38.085], [-122.5123, 38.0853], [-122.5148, 38.0911], [-122.5178, 38.0916], [-122.5232, 38.0876], [-122.5285, 38.0877], [-122.5282, 38.0815], [-122.5338, 38.0843], [-122.5348, 38.0874], [-122.5463, 38.0799], [-122.5606, 38.0937], [-122.5619, 38.0969], [-122.5618, 38.1026], [-122.5651, 38.107], [-122.566, 38.1107], [-122.5758, 38.1142], [-122.5782, 38.113], [-122.5778, 38.1106], [-122.581, 38.1117], [-122.5821, 38.1094], [-122.588, 38.1138], [-122.5857, 38.1171], [-122.5858, 38.1203], [-122.5815, 38.1261], [-122.5739, 38.1273], [-122.5734, 38.1258], [-122.5664, 38.1227], [-122.5645, 38.1319], [-122.5653, 38.1349], [-122.5778, 38.1384], [-122.5805, 38.1363], [-122.5921, 38.1459], [-122.6073, 38.1469], [-122.6211, 38.1526], [-122.6345, 38.1506], [-122.6414, 38.1467], [-122.6481, 38.1505], [-122.6471, 38.1537], [-122.6421, 38.1567], [-122.6425, 38.161], [-122.6453, 38.1659], [-122.6497, 38.1816], [-122.6379, 38.1802], [-122.6339, 38.1785], [-122.6282, 38.1789], [-122.6254, 38.1827], [-122.6221, 38.1829], [-122.6047, 38.1807], [-122.5979, 38.1874], [-122.5928, 38.1888], [-122.5915, 38.1876]]], [[[-122.5667, 38.1108], [-122.5618, 38.1026], [-122.5618, 38.0964], [-122.5593, 38.0922], [-122.5651, 38.088], [-122.5677, 38.0923], [-122.5743, 38.091], [-122.5769, 38.0928], [-122.5756, 38.0964], [-122.5836, 38.0999], [-122.579, 38.1062], [-122.5834, 38.1082], [-122.5816, 38.1094], [-122.5815, 38.1114], [-122.5778, 38.1106], [-122.5782, 38.113], [-122.5757, 38.1142], [-122.5667, 38.1108]]], [[[-122.606, 38.1469], [-122.5921, 38.1459], [-122.5805, 38.1363], [-122.5778, 38.1384], [-122.5653, 38.1349], [-122.5645, 38.1319], [-122.5664, 38.1227], [-122.5734, 38.1258], [-122.5739, 38.1273], [-122.5762, 38.1274], [-122.5832, 38.1248], [-122.5858, 38.1203], [-122.5857, 38.1171], [-122.588, 38.1138], [-122.5936, 38.1162], [-122.5994, 38.1167], [-122.6041, 38.1146], [-122.6057, 38.106], [-122.6177, 38.1032], [-122.6167, 38.1016], [-122.6182, 38.0991], [-122.6153, 38.0973], [-122.6164, 38.0905], [-122.613, 38.09], [-122.6136, 38.0871], [-122.6211, 38.0864], [-122.6262, 38.0895], [-122.6279, 38.0883], [-122.6276, 38.0865], [-122.6351, 38.0842], [-122.6374, 38.0808], [-122.6395, 38.0801], [-122.6431, 38.0881], [-122.6465, 38.0903], [-122.653, 38.0896], [-122.6551, 38.0879], [-122.6675, 38.0879], [-122.6671, 38.1051], [-122.6526, 38.1066], [-122.6297, 38.1056], [-122.63, 38.12], [-122.6254, 38.1224], [-122.6197, 38.1196], [-122.6171, 38.1248], [-122.6147, 38.1261], [-122.6089, 38.1388], [-122.6088, 38.1478], [-122.606, 38.1469]]], [[[-122.5977, 38.1162], [-122.5893, 38.1147], [-122.5822, 38.1104], [-122.5834, 38.1082], [-122.579, 38.1062], [-122.5836, 38.0999], [-122.5756, 38.0964], [-122.5769, 38.0928], [-122.5758, 38.0922], [-122.5866, 38.0855], [-122.5844, 38.0689], [-122.588, 38.0691], [-122.5942, 38.0663], [-122.5746, 38.048], [-122.5711, 38.0463], [-122.573, 38.0454], [-122.5829, 38.0489], [-122.5883, 38.0492], [-122.5904, 38.053], [-122.5953, 38.0538], [-122.6254, 38.0711], [-122.6385, 38.0761], [-122.6395, 38.0801], [-122.6374, 38.0808], [-122.6351, 38.0842], [-122.6276, 38.0865], [-122.6279, 38.0883], [-122.6262, 38.0895], [-122.6211, 38.0864], [-122.6168, 38.0862], [-122.6129, 38.0877], [-122.613, 38.09], [-122.6164, 38.0905], [-122.6153, 38.0973], [-122.6182, 38.0991], [-122.6167, 38.1016], [-122.6177, 38.1032], [-122.6057, 38.106], [-122.6041, 38.1146], [-122.5995, 38.1167], [-122.5977, 38.1162]]], [[[-122.573, 38.0906], [-122.5677, 38.0923], [-122.5651, 38.088], [-122.5593, 38.0922], [-122.543, 38.0767], [-122.5399, 38.0714], [-122.5494, 38.0714], [-122.5496, 38.0732], [-122.5477, 38.0746], [-122.5512, 38.0758], [-122.5592, 38.0766], [-122.5639, 38.0752], [-122.5663, 38.077], [-122.569, 38.077], [-122.5683, 38.0749], [-122.5706, 38.0754], [-122.5759, 38.0737], [-122.5824, 38.0688], [-122.5845, 38.0694], [-122.5866, 38.0855], [-122.576, 38.0922], [-122.573, 38.0906]]], [[[-122.5663, 38.077], [-122.5639, 38.0752], [-122.5592, 38.0766], [-122.5512, 38.0758], [-122.5477, 38.0746], [-122.5496, 38.0732], [-122.5494, 38.0714], [-122.5399, 38.0714], [-122.5308, 38.0566], [-122.532, 38.049], [-122.5367, 38.0418], [-122.5543, 38.0468], [-122.5711, 38.0463], [-122.5746, 38.048], [-122.5942, 38.0663], [-122.588, 38.0691], [-122.5824, 38.0688], [-122.5772, 38.0733], [-122.5706, 38.0754], [-122.5683, 38.0749], [-122.569, 38.077], [-122.5663, 38.077]]]]}}, {"type": "Feature", "properties": {"District": "San Rafael High School District"}, "geometry": {"type": "MultiPolygon", "coordinates": [[[[-122.5858, 38.0257], [-122.5765, 38.0253], [-122.5738, 38.0269], [-122.5692, 38.0252], [-122.5591, 38.0255], [-122.5512, 38.0271], [-122.5447, 38.0248], [-122.5393, 38.0213], [-122.5421, 38.0132], [-122.541, 38.0059], [-122.5386, 38.0037], [-122.5327, 38.0116], [-122.5331, 38.0104], [-122.5308, 38.0082], [-122.5297, 38.0104], [-122.5243, 38.0082], [-122.5242, 38.0062], [-122.5291, 38.0033], [-122.5268, 38.0015], [-122.5297, 37.9993], [-122.5277, 37.9973], [-122.5281, 37.9961], [-122.5242, 37.9951], [-122.5206, 37.9921], [-122.5219, 37.9913], [-122.5226, 37.9929], [-122.5257, 37.9905], [-122.5291, 37.9906], [-122.5333, 37.9867], [-122.5451, 37.9881], [-122.5441, 37.989], [-122.5503, 37.9917], [-122.5576, 37.9932], [-122.571, 38.0096], [-122.5897, 38.0238], [-122.5871, 38.0274], [-122.5858, 38.0257]]], [[[-122.5568, 37.9932], [-122.5503, 37.9917], [-122.5441, 37.989], [-122.5451, 37.9881], [-122.5371, 37.9869], [-122.5333, 37.9867], [-122.53, 37.99], [-122.5289, 37.9888], [-122.5298, 37.9886], [-122.5296, 37.9846], [-122.5272, 37.9837], [-122.5252, 37.9801], [-122.5219, 37.9786], [-122.5243, 37.9693], [-122.5217, 37.9674], [-122.5222, 37.9644], [-122.5207, 37.9624], [-122.5164, 37.959], [-122.5172, 37.9571], [-122.52, 37.9589], [-122.521, 37.958], [-122.519, 37.9574], [-122.518, 37.9553], [-122.5153, 37.9559], [-122.514, 37.9524], [-122.5175, 37.9519], [-122.5284, 37.9588], [-122.5325, 37.96], [-122.5328, 37.9613], [-122.5387, 37.9633], [-122.5382, 37.9642], [-122.5436, 37.9653], [-122.5456, 37.9669], [-122.5452, 37.9685], [-122.5461, 37.9669], [-122.5486, 37.9723], [-122.5509, 37.9722], [-122.5504, 37.9808], [-122.5573, 37.9835], [-122.561, 37.9792], [-122.5568, 37.9932]]], [[[-122.4566, 37.9969], [-122.4512, 37.9984], [-122.4491, 37.9965], [-122.4436, 37.9887], [-122.4428, 37.9846], [-122.4444, 37.9818], [-122.4384, 37.9774], [-122.4416, 37.9739], [-122.4415, 37.9606], [-122.435, 37.9368], [-122.4893, 37.9363], [-122.4959, 37.9383], [-122.5022, 37.942], [-122.5135, 37.9433], [-122.5132, 37.9469], [-122.5095, 37.9519], [-122.5058, 37.9512], [-122.5002, 37.9469], [-122.4913, 37.9465], [-122.5056, 37.96], [-122.4984, 37.9617], [-122.4969, 37.9665], [-122.4997, 37.9681], [-122.499, 37.9698], [-122.5076, 37.9663], [-122.5149, 37.9698], [-122.5142, 37.9718], [-122.5203, 37.9738], [-122.5202, 37.9806], [-122.5215, 37.9819], [-122.5226, 37.9807], [-122.5219, 37.9786], [-122.5242, 37.9804], [-122.5243, 37.9794], [-122.5272, 37.9837], [-122.5296, 37.9846], [-122.5298, 37.9886], [-122.5289, 37.9888], [-122.53, 37.99], [-122.5247, 37.9909], [-122.5226, 37.9929], [-122.5219, 37.9913], [-122.5182, 37.9913], [-122.5119, 37.9967], [-122.508, 37.9959], [-122.503, 37.9985], [-122.5013, 37.9968], [-122.4955, 37.9977], [-122.4879, 37.9958], [-122.4751, 38.0023], [-122.4653, 38.0004], [-122.4566, 37.9969]]], [[[-122.5082, 37.9664], [-122.499, 37.9698], [-122.4997, 37.9681], [-122.4969, 37.9665], [-122.4984, 37.9617], [-122.5056, 37.96], [-122.4913, 37.9465], [-122.5002, 37.9469], [-122.5058, 37.9512], [-122.5149, 37.9529], [-122.5153, 37.9559], [-122.518, 37.9553], [-122.5192, 37.9575], [-122.5208, 37.9575], [-122.52, 37.9589], [-122.5172, 37.9571], [-122.5163, 37.9587], [-122.522, 37.9642], [-122.5217, 37.9674], [-122.5244, 37.9695], [-122.5218, 37.9791], [-122.5226, 37.9807], [-122.5215, 37.9819], [-122.5195, 37.9793], [-122.5203, 37.9738], [-122.5142, 37.9718], [-122.5149, 37.9698], [-122.5082, 37.9664]]], [[[-122.5988, 38.0556], [-122.5904, 38.053], [-122.5883, 38.0492], [-122.5829, 38.0489], [-122.573, 38.0454], [-122.5543, 38.0468], [-122.5367, 38.0418], [-122.5361, 38.0427], [-122.5317, 38.0427], [-122.5257, 38.0397], [-122.5048, 38.0409], [-122.4954, 38.0408], [-122.4958, 38.0399], [-122.3828, 38.0398], [-122.3928, 38.027], [-122.4384, 37.9774], [-122.4444, 37.9818], [-122.4428, 37.9846], [-122.4436, 37.9887], [-122.4512, 37.9984], [-122.4565, 37.9969], [-122.4653, 38.0004], [-122.4751, 38.0023], [-122.4879, 37.9958], [-122.4955, 37.9977], [-122.5013, 37.9968], [-122.503, 37.9985], [-122.508, 37.9959], [-122.5119, 37.9967], [-122.5182, 37.9913], [-122.5207, 37.9919], [-122.5242, 37.9951], [-122.5281, 37.9961], [-122.5277, 37.9973], [-122.5297, 37.9993], [-122.5268, 38.0015], [-122.5291, 38.0033], [-122.5242, 38.0062], [-122.5241, 38.008], [-122.5297, 38.0104], [-122.5309, 38.0082], [-122.5331, 38.0104], [-122.5327, 38.0116], [-122.5393, 38.0037], [-122.5421, 38.0099], [-122.5419, 38.0145], [-122.5393, 38.0213], [-122.5501, 38.0269], [-122.5591, 38.0255], [-122.5692, 38.0252], [-122.5738, 38.0269], [-122.5765, 38.0253], [-122.5851, 38.0254], [-122.5866, 38.0275], [-122.5897, 38.0238], [-122.597, 38.0292], [-122.6124, 38.0232], [-122.6176, 38.0194], [-122.6323, 38.0255], [-122.6365, 38.026], [-122.6355, 38.0277], [-122.6437, 38.0475], [-122.6393, 38.0516], [-122.6308, 38.0638], [-122.6322, 38.0737], [-122.6254, 38.0711], [-122.5988, 38.0556]]]]}}]};

const districtData = {
  "Tamalpais School District": {
    label: "Tamalpais Union High",
    ela: 68.72, math: 54.19, elaN: 1087, mathN: 1098,
    ela_exceeded: 39.74, ela_met: 28.98, ela_nearly: 13.80, ela_not: 17.48,
    math_exceeded: 28.14, math_met: 26.05, math_nearly: 23.77, math_not: 22.04,
  },
  "Novato Unified": {
    label: "Novato Unified",
    ela: 52.70, math: 41.53, elaN: 3535, mathN: 3552,
    ela_exceeded: 24.67, ela_met: 28.03, ela_nearly: 19.60, ela_not: 27.69,
    math_exceeded: 21.76, math_met: 19.76, math_nearly: 22.30, math_not: 36.18,
  },
  "San Rafael High School District": {
    label: "San Rafael City High",
    ela: 55.67, math: 31.49, elaN: 573, mathN: 597,
    ela_exceeded: 26.18, ela_met: 29.49, ela_nearly: 18.85, ela_not: 25.48,
    math_exceeded: 15.58, math_met: 15.91, math_nearly: 19.60, math_not: 48.91,
  },
  "Shoreline Unified": {
    label: "Shoreline Unified",
    ela: 35.17, math: 31.78, elaN: 236, mathN: 236,
    ela_exceeded: 15.25, ela_met: 19.92, ela_nearly: 29.24, ela_not: 35.59,
    math_exceeded: 8.47, math_met: 23.31, math_nearly: 31.36, math_not: 36.86,
  },
  "Petaluma High School District": {
    label: "Petaluma Joint Union HSD",
    ela: null, math: null, elaN: 0, mathN: 0,
  },
};

function getColor(pct) {
  if (pct === null) return "#2a2a35";
  if (pct >= 65) return "#15803d";
  if (pct >= 55) return "#4ade80";
  if (pct >= 45) return "#fbbf24";
  if (pct >= 35) return "#f97316";
  return "#dc2626";
}

function getStroke(pct) {
  if (pct === null) return "#444";
  if (pct >= 65) return "#0f5c2e";
  if (pct >= 55) return "#16a34a";
  if (pct >= 45) return "#d99e0b";
  if (pct >= 35) return "#ea580c";
  return "#b91c1c";
}

const legendStops = [
  { label: "65%+", color: "#15803d" },
  { label: "55\u201364", color: "#4ade80" },
  { label: "45\u201354", color: "#fbbf24" },
  { label: "35\u201344", color: "#f97316" },
  { label: "<35%", color: "#dc2626" },
  { label: "No data", color: "#2a2a35" },
];

function Bar({ label, value, color, width }) {
  return (
    <div style={{ display: "flex", alignItems: "center", gap: 6, marginBottom: 3 }}>
      <div style={{ width: 70, fontSize: 10, color: "#94a3b8", textAlign: "right" }}>{label}</div>
      <div style={{ flex: 1, background: "#1e293b", borderRadius: 3, height: 14, overflow: "hidden" }}>
        <div
          style={{
            width: `${value}%`,
            height: "100%",
            background: color,
            borderRadius: 3,
            transition: "width 0.3s ease",
          }}
        />
      </div>
      <div style={{ width: 38, fontSize: 10, color: "#cbd5e1", textAlign: "right" }}>{value}%</div>
    </div>
  );
}

export default function MarinHSMap() {
  const [subject, setSubject] = useState("ela");
  const [hovered, setHovered] = useState(null);
  const [selected, setSelected] = useState(null);
  const [tooltipPos, setTooltipPos] = useState({ x: 0, y: 0 });

  const width = 560;
  const height = 640;

  const { proj, pathGen } = useMemo(() => {
    const p = d3.geoMercator().fitSize([width - 40, height - 40], geoData);
    const [tx, ty] = p.translate();
    p.translate([tx + 20, ty + 20]);
    return { proj: p, pathGen: d3.geoPath().projection(p) };
  }, []);

  const active = selected || hovered;
  const activeData = active ? districtData[active] : null;

  return (
    <div
      style={{
        background: "#0f1117",
        minHeight: "100vh",
        fontFamily: "system-ui, -apple-system, sans-serif",
        color: "#e2e8f0",
        padding: "20px 16px",
        boxSizing: "border-box",
      }}
    >
      <div style={{ maxWidth: 640, margin: "0 auto" }}>
        <h1 style={{ fontSize: 22, fontWeight: 700, margin: "0 0 2px", color: "#f8fafc", fontFamily: "Georgia, serif" }}>
          Marin County High School Districts
        </h1>
        <p style={{ fontSize: 13, color: "#64748b", margin: "0 0 16px" }}>
          2025 CAASPP â€” % meeting or exceeding standards
        </p>

        <div style={{ display: "flex", gap: 0, marginBottom: 16 }}>
          {["ela", "math"].map((s) => (
            <button
              key={s}
              onClick={() => setSubject(s)}
              style={{
                padding: "8px 32px",
                fontSize: 13,
                fontWeight: 600,
                letterSpacing: "0.06em",
                border: subject === s ? "1.5px solid #94a3b8" : "1px solid #334155",
                background: subject === s ? "#1e293b" : "transparent",
                color: subject === s ? "#f1f5f9" : "#64748b",
                cursor: "pointer",
                borderRadius: s === "ela" ? "5px 0 0 5px" : "0 5px 5px 0",
                borderLeft: s === "math" ? "none" : undefined,
                transition: "all 0.15s",
              }}
            >
              {s === "ela" ? "ELA" : "MATH"}
            </button>
          ))}
        </div>

        <div style={{ display: "flex", gap: 16, flexWrap: "wrap" }}>
          <div style={{ flex: "1 1 340px", position: "relative" }}>
            <svg
              viewBox={`0 0 ${width} ${height}`}
              style={{ width: "100%", height: "auto", display: "block" }}
              onMouseLeave={() => { if (!selected) setHovered(null); }}
            >
              <rect width={width} height={height} fill="#0f1117" />

              {geoData.features.map((feature) => {
                const name = feature.properties.District;
                const d = districtData[name];
                if (!d) return null;
                const pct = subject === "ela" ? d.ela : d.math;
                const fill = getColor(pct);
                const stroke = getStroke(pct);
                const isActive = active === name;
                const hasActive = !!active;
                const pathD = pathGen(feature);

                return (
                  <path
                    key={name}
                    d={pathD}
                    fill={fill}
                    stroke={isActive ? "#fff" : stroke}
                    strokeWidth={isActive ? 2.5 : 1}
                    opacity={hasActive && !isActive ? 0.35 : 1}
                    style={{ cursor: "pointer", transition: "opacity 0.2s, stroke-width 0.15s" }}
                    onMouseEnter={() => { if (!selected) setHovered(name); }}
                    onClick={() => setSelected(selected === name ? null : name)}
                  />
                );
              })}

              {geoData.features.map((feature) => {
                const name = feature.properties.District;
                const d = districtData[name];
                if (!d) return null;
                const pct = subject === "ela" ? d.ela : d.math;
                const centroid = pathGen.centroid(feature);
                if (!centroid || isNaN(centroid[0])) return null;
                const isActive = active === name;
                const hasActive = !!active;

                return (
                  <g
                    key={`lbl-${name}`}
                    opacity={hasActive && !isActive ? 0.25 : 1}
                    style={{ transition: "opacity 0.2s", pointerEvents: "none" }}
                  >
                    <text
                      x={centroid[0]}
                      y={centroid[1] - 8}
                      textAnchor="middle"
                      fill="#fff"
                      fontSize={14}
                      fontWeight="700"
                      style={{ textShadow: "0 1px 6px rgba(0,0,0,0.9), 0 0 3px rgba(0,0,0,0.9)" }}
                    >
                      {pct !== null ? `${pct.toFixed(0)}%` : ""}
                    </text>
                    <text
                      x={centroid[0]}
                      y={centroid[1] + 6}
                      textAnchor="middle"
                      fill="#fff"
                      fontSize={9}
                      opacity={0.7}
                      style={{ textShadow: "0 1px 6px rgba(0,0,0,0.9), 0 0 3px rgba(0,0,0,0.9)" }}
                    >
                      {d.label}
                    </text>
                  </g>
                );
              })}
            </svg>
          </div>

          <div style={{ flex: "1 1 220px", minWidth: 220 }}>
            {activeData && activeData.ela !== null ? (
              <div
                style={{
                  background: "#1a1e2a",
                  borderRadius: 10,
                  padding: "16px 18px",
                  border: "1px solid #2a3040",
                }}
              >
                <div style={{ fontSize: 16, fontWeight: 700, color: "#f8fafc", marginBottom: 2, fontFamily: "Georgia, serif" }}>
                  {activeData.label}
                </div>
                <div style={{ fontSize: 11, color: "#64748b", marginBottom: 14 }}>
                  {subject === "ela" ? activeData.elaN.toLocaleString() : activeData.mathN.toLocaleString()} students tested
                </div>

                <div style={{ marginBottom: 14 }}>
                  <div style={{ fontSize: 11, fontWeight: 600, color: "#94a3b8", marginBottom: 6, textTransform: "uppercase", letterSpacing: "0.06em" }}>
                    {subject === "ela" ? "ELA" : "Math"} Performance
                  </div>
                  <Bar label="Exceeded" value={subject === "ela" ? activeData.ela_exceeded : activeData.math_exceeded} color="#15803d" />
                  <Bar label="Met" value={subject === "ela" ? activeData.ela_met : activeData.math_met} color="#4ade80" />
                  <Bar label="Nearly Met" value={subject === "ela" ? activeData.ela_nearly : activeData.math_nearly} color="#fbbf24" />
                  <Bar label="Not Met" value={subject === "ela" ? activeData.ela_not : activeData.math_not} color="#ef4444" />
                </div>

                <div style={{ display: "flex", gap: 16 }}>
                  <div>
                    <div style={{ fontSize: 9, color: "#64748b", textTransform: "uppercase", letterSpacing: "0.05em" }}>ELA</div>
                    <div style={{ fontSize: 22, fontWeight: 700, color: getColor(activeData.ela) }}>
                      {activeData.ela.toFixed(1)}%
                    </div>
                  </div>
                  <div>
                    <div style={{ fontSize: 9, color: "#64748b", textTransform: "uppercase", letterSpacing: "0.05em" }}>Math</div>
                    <div style={{ fontSize: 22, fontWeight: 700, color: getColor(activeData.math) }}>
                      {activeData.math.toFixed(1)}%
                    </div>
                  </div>
                </div>
              </div>
            ) : (
              <div
                style={{
                  background: "#1a1e2a",
                  borderRadius: 10,
                  padding: "24px 18px",
                  border: "1px solid #2a3040",
                  textAlign: "center",
                  color: "#475569",
                  fontSize: 13,
                }}
              >
                {active ? "No CAASPP data for this district (extends into Sonoma County)" : "Hover or click a district to see details"}
              </div>
            )}
          </div>
        </div>

        <div style={{ display: "flex", gap: 6, marginTop: 14, flexWrap: "wrap", alignItems: "center" }}>
          <span style={{ fontSize: 10, color: "#475569", marginRight: 4, letterSpacing: "0.04em", textTransform: "uppercase" }}>
            % Met/Exceeded:
          </span>
          {legendStops.map((s) => (
            <div key={s.label} style={{ display: "flex", alignItems: "center", gap: 3 }}>
              <div style={{ width: 13, height: 13, borderRadius: 2, background: s.color, border: s.color === "#2a2a35" ? "1px solid #444" : "none" }} />
              <span style={{ fontSize: 10, color: "#94a3b8" }}>{s.label}</span>
            </div>
          ))}
        </div>

        <p style={{ fontSize: 10, color: "#334155", marginTop: 14, lineHeight: 1.6 }}>
          Source: 2025 CAASPP results, all students, all grades. District boundaries from Marin County GIS Open Data.
          Petaluma Joint Union HSD extends into Marin but is primarily in Sonoma County (no Marin CAASPP data).
        </p>
      </div>
    </div>
  );
}
